pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
-- constants
max_players = 3
min_players = 1
player_num = 1

-- player animation
player_frames = {1,2,3}  -- sprite numbers
player_anim_speed = 0.2
player_anim_timer = 0
player_anim_index = 1

-- reward bar
bar_width = 64
bar_height = 6
bar_x = 25
bar_y = 110
bar_fill = 0
base_rate = 0.3
rewards = {17,18,19}
current_reward_index = 1
reward_timer = -1
last_reward = rewards[current_reward_index]



function _update()
current_rate = base_rate*player_num

  -- change number of players
  if (btnp(0)) then
    player_num = max(min_players, player_num-1)
  elseif (btnp(1)) then
    player_num = min(max_players, player_num+1)
  end

  -- animate player
  player_anim_timer += player_anim_speed
  if player_anim_timer > 1 then
    player_anim_timer = 0
    player_anim_index += 1
    if player_anim_index > #player_frames then player_anim_index = 1 end
  end
		
-- fill reward bar
bar_fill += base_rate * player_num
if bar_fill >= bar_width then
    bar_fill = 0
    last_reward = rewards[current_reward_index]

    -- pick next reward
    current_reward_index += 1
    if current_reward_index > #rewards then current_reward_index = 1 end

    -- start reward timer
    reward_timer = 0
end
		
		-- increment reward timer if active
		if reward_timer >=0 and reward_timer< 30 then
		    reward_timer += 1
		end
  
end

function _draw()
  cls(4)
  fillp(ˇ)
  rectfill(0,0,128,127,3)
  fillp()
  rectfill(0,bar_y-15,128,bar_y+15,0)
		rectfill(0,15,128,40,2)


-- draw background block from tile (0,0) to (3,3)
map(0,0,45,50,4,4,0)

  -- print number of players
  print("number of players", 30,20,7)
		print("⬅️ "..player_num.." ➡️", 48, 30, 7)
		

local block_start_x = 0
local block_start_y = 0

for i=1,player_num do
  local px = (block_start_x+5.4 + i-1) * 9
  local py = block_start_y+7 * 8
  spr(player_frames[player_anim_index], px, py)
end

  -- draw reward bar background
  rectfill(bar_x,bar_y,bar_x+bar_width,bar_y+bar_height,1)
  -- draw reward bar fill
  rectfill(bar_x,bar_y,bar_x+bar_fill,bar_y+bar_height,7)
  -- draw reward sprite at end
  spr(rewards[current_reward_index], bar_x+bar_width+5, bar_y)
  
  -- draw bar filling
  print("filling rate: "..current_rate, 30,100,6)
  
		-- show rewarded text if timer is active
		if reward_timer >= 0 and reward_timer < 30 then
		    rectfill(0,100,128,107,0)
		    spr(last_reward, bar_x+10, bar_y-12)
		    print(" rewarded", bar_x+20, bar_y-10, 9)
		end
end

__gfx__
00000000000ff000000ff000000ff000000000000000000000000000000000000000000066666666666666666666666666666666000000000000000000000000
00000000000ff000000ff000000ff0000000000000000000000000000000000000000000666666666666cccccccc666666666666000000000000000000000000
007007000f1111f00f1111f00f1111f0000000000000000000000000000000000000000065555555555666666666655555555556000000000000000000000000
000770000f1111f00f1111f00f1111f0000000000000000000000000000000000000000065555555555566666666555555555556000000000000000000000000
000770000f1111000f1111f0001111f0000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00700700002222000022220000222200000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
0000000000f002000020020000200f00000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
0000000000000f0000f00f0000f00000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
0000000000000ff00000666000aaaa00000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000033ff000600000a9999a0000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
0000000000033b3f0999f990a9aaaa9a000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
0000000000333330099f9990a9a9aa9a000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
0000000003b3b3000aaaaaa0a9aa9a9a000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000f33330000aaaaaa0a9aaaa9a000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000ff3300000aaaaaa00a9999a0000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
000000000ff000000999f99000aaaa00000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000065555555555555555555555555555556000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000066666555555555555555555555566666000000000000000000000000
__label__
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222277227272777277727772777222222772777222227772722277727272777277722772222222222222222222222222222222
22222222222222222222222222222272727272777272727222727222227272722222227272722272727272722272727222222222222222222222222222222222
22222222222222222222222222222272727272727277227722772222227272772222227772722277727772772277227772222222222222222222222222222222
22222222222222222222222222222272727272727272727222727222227272722222227222722272722272722272722272222222222222222222222222222222
22222222222222222222222222222272722772727277727772727222227722722222227222777272727772777272727722222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222227777722222277722222277777222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222277722772222222722222772277722222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222277222772222277722222772227722222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222277722772222272222222772277722222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222227777722222277722222277777222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344466666666666666666666666666666666344434443444344434443444344434443444344434443444344
444444444444444444444444444444444444444444444666666666666cccccccc666666666666444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444465555555555666666666655555555556444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434365555555555566666666555555555556434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344465555555555555555555555555555556344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
444444444444444444444444444444444444444444444655555ff5555555ff555555555555556444444444444444444444444444444444444444444444444444
343434343434343434343434343434343434343434343655555ff5555555ff555555555555556434343434343434343434343434343434343434343434343434
4344434443444344434443444344434443444344434446555f1111f555f1111f5555555555556344434443444344434443444344434443444344434443444344
4444444444444444444444444444444444444444444446555f1111f555f1111f5555555555556444444444444444444444444444444444444444444444444444
444444444444444444444444444444444444444444444655551111f55551111f5555555555556444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434365555222255555222255555555555556434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344465555255f55555255f55555555555556344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444465555f55555555f55555555555555556444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434365555555555555555555555555555556434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344465555555555555555555555555555556344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434365555555555555555555555555555556434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344465555555555555555555555555555556344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434365555555555555555555555555555556434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344465555555555555555555555555555556344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434365555555555555555555555555555556434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344465555555555555555555555555555556344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444465555555555555555555555555555556444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434366666555555555555555555555566666434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444
34343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000ff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000033ff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000033b3f0000009990999090909990999099009990990000000000000000000000000000000000000000000000000
00000000000000000000000000000000000003333300000009090900090909090909090909000909000000000000000000000000000000000000000000000000
0000000000000000000000000000000000003b3b3000000009900990090909990990090909900909000000000000000000000000000000000000000000000000
00000000000000000000000000000000000f33330000000009090900099909090909090909000909000000000000000000000000000000000000000000000000
00000000000000000000000000000000000ff3300000000009090999099909090909099909990999000000000000000000000000000000000000000000000000
000000000000000000000000000000000000ff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000007777777777711111111111111111111111111111111111111111111111111111100000000666000000000000000000000000000
00000000000000000000000007777777777711111111111111111111111111111111111111111111111111111100000006000000000000000000000000000000
00000000000000000000000007777777777711111111111111111111111111111111111111111111111111111100000999f99000000000000000000000000000
0000000000000000000000000777777777771111111111111111111111111111111111111111111111111111110000099f999000000000000000000000000000
00000000000000000000000007777777777711111111111111111111111111111111111111111111111111111100000aaaaaa000000000000000000000000000
00000000000000000000000007777777777711111111111111111111111111111111111111111111111111111100000aaaaaa000000000000000000000000000
00000000000000000000000007777777777711111111111111111111111111111111111111111111111111111100000aaaaaa000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999f99000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
43444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344434443444344
44444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444444

__map__
090a0b0c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
191a1b1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
292a2b2c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
393a3b3c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
